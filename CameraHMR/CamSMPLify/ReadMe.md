# Introduction
The CamSMPLify repository includes code for optimizing initial SMPL pose and shape parameters generated by CameraHMR using 2D keypoints. The provided demo script runs optimization on a sample file, `filtered_aic.npz`, which contain the pose, shape and cam_int generated by the first version of [CameraHMR](docs/training.md) trained on BEDLAM and AGORA datasets.  

The `filtered_aic.npz` file contains the following key fields:  
- **pose** and **shape** – SMPL model parameters  
- **cam_int** and **cam_t** – Camera intrinsics and translation  
- **center** and **scale** – Image cropping information  

Additionally, the **gt_keypoints** field, sourced from [4DHumans](https://github.com/shubham-goel/4D-Humans?tab=readme-ov-file), provides ground-truth keypoints. If you want to use CamSMPLify to fit on new images, you'll need to generate these keypoints using VitPose or another tool that outputs keypoints in the OpenPose format.  

If no ground-truth keypoints are provided, the code projects SMPL vertices onto the image to estimate them, though this may reduce accuracy. The **dense_kp** field is generated by running [DenseKP](../docs/training.md) model on the images.


# Run Optimization
## Download demo files
First run following script to download demo files for running optimization. Note that you need to register on [CameraHMR](https://camerahmr.is.tue.mpg.de/index.html) website for running the script
```
bash download_data.sh
```
Once the necessary files are downloaded, you can run the following script to run optimization.

```
python optimize.py
```

# Visualization
You can enable visualization to observe the fitting process. This will display the SMPL overlay on the image every 100 iterations by default. To use this feature, ensure you have OpenCV installed with GUI support. You can run `pip install opencv-contrib-python` for it if its not supported.
```
python optimize.py --vis True
```
